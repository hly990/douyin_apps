<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <text class="header-title">ä¸ºä½ æ¨è</text>
  </view>
  
  <!-- è§†é¢‘æ’­æ”¾åŒºåŸŸ - ç±»ä¼¼æŠ–éŸ³çš„ä¸Šä¸‹æ»‘åŠ¨åˆ‡æ¢è§†é¢‘ -->
  <swiper 
    class="video-swiper" 
    vertical="{{true}}" 
    current="{{currentIndex}}" 
    duration="300"
    bindchange="handleSwiperChange"
    style="height: {{screenHeight}}px">
    <block tt:for="{{videoList}}" tt:key="id">
      <swiper-item class="video-swiper-item">
        <video 
          id="video-{{item.id}}"
          class="video-player"
          src="{{item.videoUrl}}" 
          object-fit="contain"
          autoplay="{{currentIndex === index}}"
          loop="{{true}}"
          show-play-btn="{{false}}"
          controls="{{false}}"
          enable-progress-gesture="{{false}}"
          bindplay="handleVideoPlay"
          bindpause="handleVideoPause"
          bindended="handleVideoEnded"
          bindtap="handleVideoTap"
        ></video>

        <!-- ä¾§è¾¹æ“ä½œæ  -->
        <view class="side-bar">
          <!-- ç‚¹èµ -->
          <view class="action-item" bindtap="likeVideo" data-id="{{item.id}}" data-index="{{index}}">
            <view class="action-icon {{item.isLiked ? 'active' : ''}}">
              <text class="action-icon-inner">{{item.isLiked ? 'â¤ï¸' : 'â™¡'}}</text>
            </view>
            <text class="action-text">{{item.likes || 0}}</text>
          </view>
          
          <!-- æ”¶è— -->
          <view class="action-item" bindtap="collectVideo" data-id="{{item.id}}" data-index="{{index}}">
            <view class="action-icon {{item.isCollected ? 'active' : ''}}">
              <text class="action-icon-inner">{{item.isCollected ? 'â˜…' : 'â˜†'}}</text>
            </view>
            <text class="action-text">æ”¶è—</text>
          </view>
        </view>

        <!-- è‡ªå®šä¹‰æ’­æ”¾/æš‚åœæŒ‰é’® -->
        <view class="play-pause-btn" tt:if="{{!isPlaying && currentIndex === index}}" bindtap="handleVideoTap">
          <text class="play-icon">â–¶</text>
        </view>
      </swiper-item>
    </block>
  </swiper>
  
  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
  <view class="safe-area-bottom"></view>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-indicator" tt:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">è§†é¢‘åŠ è½½ä¸­...</text>
  </view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" tt:if="{{videoList.length === 0 && !isLoading}}">
    <text class="empty-icon">ğŸ“º</text>
    <text class="empty-text">æš‚æ— æ¨èè§†é¢‘</text>
  </view>
  
  <!-- æ·»åŠ ä¸€ä¸ªå›ºå®šåœ¨åº•éƒ¨çš„å¯¼èˆªæ  -->
  <view class="fixed-tab-bar">
    <view class="tab-item" bindtap="navigateToIndex">
      <view class="tab-icon">ğŸ </view>
      <view class="tab-text">é¦–é¡µ</view>
    </view>
    <view class="tab-item active">
      <view class="tab-icon">ğŸ”</view>
      <view class="tab-text">æ¨è</view>
    </view>
    <view class="tab-item" bindtap="navigateToProfile">
      <view class="tab-icon">ğŸ‘¤</view>
      <view class="tab-text">æˆ‘çš„</view>
    </view>
  </view>
</view> 