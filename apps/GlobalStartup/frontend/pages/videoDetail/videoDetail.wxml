<view class="page">
  <!-- è§†é¢‘æ’­æ”¾åŒºåŸŸ -->
  <view class="video-container">
    <video 
      class="video" 
      src="{{videoData.videoUrl}}" 
      poster="{{videoData.coverUrl}}"
      show-center-play-btn="true"
      controls
      autoplay
      loop="{{false}}"
      object-fit="cover"
      show-progress="true"
      bindplay="onVideoPlay"
      bindpause="onVideoPause"
      bindended="onVideoEnded"
      id="myVideo"
    ></video>
  </view>

  <!-- è§†é¢‘ä¿¡æ¯åŒºåŸŸ -->
  <view class="video-info">
    <view class="video-title">{{videoData.title}}</view>
    
    <!-- ä½œè€…ä¿¡æ¯ -->
    <view class="author-info">
      <image class="author-avatar" src="{{videoData.author.avatarUrl}}" mode="aspectFill"></image>
      <view class="author-name">{{videoData.author.nickname}}</view>
      <view class="follow-btn {{isFollowing ? 'followed' : ''}}" bindtap="followAuthor">
        {{isFollowing ? 'å·²å…³æ³¨' : 'å…³æ³¨'}}
      </view>
    </view>
    
    <!-- è§†é¢‘æ•°æ®ç»Ÿè®¡ -->
    <view class="video-stats">
      <view>{{videoData.playCount || 0}} æ¬¡æ’­æ”¾</view>
      <view>{{videoData.commentCount || 0}} è¯„è®º</view>
      <view>{{utils.formatDate(videoData.createTime)}}</view>
    </view>
    
    <!-- è§†é¢‘æè¿° -->
    <view class="video-desc" wx:if="{{videoData.description}}">
      {{videoData.description}}
    </view>
  </view>

  <!-- äº’åŠ¨æ  -->
  <view class="interaction-bar">
    <view class="action-item" bindtap="likeVideo">
      <view class="action-icon">{{isLiked ? 'â¤ï¸' : 'â™¡'}}</view>
      <view class="action-text">{{videoData.likes || 0}}</view>
    </view>
    <view class="action-item" bindtap="collectVideo">
      <view class="action-icon">{{isCollected ? 'â˜…' : 'â˜†'}}</view>
      <view class="action-text">æ”¶è—</view>
    </view>
    <view class="action-item" bindtap="showComments">
      <view class="action-icon">ğŸ’¬</view>
      <view class="action-text">è¯„è®º</view>
    </view>
    <view class="action-item" bindtap="shareVideo">
      <view class="action-icon">â†—ï¸</view>
      <view class="action-text">åˆ†äº«</view>
    </view>
  </view>

  <!-- è¯„è®ºåŒº -->
  <view class="comment-section">
    <view class="section-title">ç²¾å½©è¯„è®º ({{commentList.length}})</view>
    
    <view class="comment-list" wx:if="{{commentList.length > 0}}">
      <view class="comment-item" wx:for="{{commentList}}" wx:key="id">
        <image class="commenter-avatar" src="{{item.user.avatarUrl}}" mode="aspectFill"></image>
        <view class="comment-content">
          <view class="commenter-name">{{item.user.nickname}}</view>
          <view class="comment-text">{{item.content}}</view>
          <view class="comment-actions">
            <view class="comment-time">{{utils.formatDate(item.createTime)}}</view>
            <view class="comment-like" bindtap="likeComment" data-id="{{item.id}}">
              {{item.isLiked ? 'â¤ï¸' : 'â™¡'}} {{item.likes}}
            </view>
            <view class="comment-reply" bindtap="replyComment" data-id="{{item.id}}" data-name="{{item.user.nickname}}">
              å›å¤
            </view>
          </view>
          
          <!-- å›å¤åˆ—è¡¨ -->
          <view class="reply-container" wx:if="{{item.replies && item.replies.length > 0}}">
            <view class="reply-item" wx:for="{{item.replies}}" wx:for-item="reply" wx:key="id">
              <view class="replier-name">{{reply.user.nickname}}: </view>
              <view class="reply-text">{{reply.content}}</view>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <view class="no-more" wx:if="{{commentList.length === 0}}">æš‚æ— è¯„è®ºï¼Œå¿«æ¥å‘è¡¨ç¬¬ä¸€æ¡è¯„è®ºå§</view>
  </view>

  <!-- ç›¸å…³è§†é¢‘æ¨è -->
  <view class="related-videos">
    <view class="section-title">ç›¸å…³æ¨è</view>
    
    <view class="related-video-item" wx:for="{{relatedVideos}}" wx:key="id" bindtap="onRelatedVideoTap" data-id="{{item.id}}" data-index="{{index}}">
      <view class="related-video-cover">
        <image src="{{item.coverUrl}}" mode="aspectFill" style="width: 100%; height: 100%; border-radius: 10rpx;"></image>
        <view class="video-duration">{{utils.formatDuration(item.duration)}}</view>
      </view>
      <view class="related-video-info">
        <view class="related-video-title">{{item.title}}</view>
        <view class="related-video-author">{{item.author.nickname}}</view>
        <view class="related-video-stats">
          {{item.playCount || 0}} æ¬¡æ’­æ”¾ Â· {{item.likes || 0}} ç‚¹èµ
        </view>
      </view>
    </view>
    
    <view class="loading" wx:if="{{loading}}">åŠ è½½ä¸­...</view>
    <view class="no-more" wx:if="{{relatedVideos.length === 0 && !loading}}">æš‚æ— ç›¸å…³è§†é¢‘</view>
  </view>

  <!-- è¯„è®ºè¾“å…¥æ¡† -->
  <view class="comment-input-area">
    <input class="comment-input" placeholder="è¯´ç‚¹ä»€ä¹ˆ..." value="{{commentText}}" bindinput="onCommentInput" confirm-type="send" bindconfirm="submitComment"/>
    <view class="send-btn" bindtap="submitComment">å‘é€</view>
  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
  <view class="safe-area-bottom"></view>
</view> 