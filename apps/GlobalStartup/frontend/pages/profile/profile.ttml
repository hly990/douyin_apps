<view class="profile-container">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="not-login" tt:if="{{!isLogin}}">
    <image class="login-icon" src="../../assets/icons/user-placeholder.png" mode="aspectFit"></image>
    <view class="login-tip">ç™»å½•åæŸ¥çœ‹æ‚¨çš„ä¸ªäººèµ„æ–™</view>
    <button class="login-btn" bindtap="goToLogin">ç«‹å³ç™»å½•</button>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <block tt:else>
    <!-- æ ‡ç­¾åˆ‡æ¢ -->
    <view class="tab-container">
      <view class="tab-item {{activeTab === 'favorites' ? 'active' : ''}}" 
            bindtap="switchTab" 
            data-tab="favorites">
        <text>æ”¶è—åˆ—è¡¨</text>
      </view>
      <view class="tab-item {{activeTab === 'history' ? 'active' : ''}}" 
            bindtap="switchTab" 
            data-tab="history">
        <text>çœ‹è¿‡åˆ—è¡¨</text>
      </view>
    </view>
    
    <!-- æ“ä½œæ  - æ¸…ç©ºå†å²æŒ‰é’® -->
    <view class="action-bar" tt:if="{{activeTab === 'history'}}">
      <view class="clear-history-btn" bindtap="clearHistory">
        <text class="clear-icon">ğŸ—‘ï¸</text>
        <text class="clear-text">æ¸…ç©ºå†å²è®°å½•</text>
      </view>
    </view>
    
    <!-- è§†é¢‘åˆ—è¡¨ -->
    <view class="video-grid" tt:if="{{videos.length > 0}}">
      <view class="video-item" 
            tt:for="{{videos}}" 
            tt:key="id" 
            bindtap="onTapVideo" 
            data-id="{{item.id}}">
        <view class="video-cover-container">
          <image class="video-cover" src="{{item.coverUrl}}" mode="aspectFill"></image>
          <view class="video-duration">{{utils.formatDuration(item.duration)}}</view>
          <view class="video-play-count">
            <text class="play-icon">â–¶</text>
            <text>{{utils.formatCount(item.playCount)}}</text>
          </view>
          <!-- è§‚çœ‹è¿›åº¦æ¡ï¼ˆä»…åœ¨å†å²è®°å½•ä¸­æ˜¾ç¤ºï¼‰ -->
          <view class="watch-progress" tt:if="{{activeTab === 'history' && item.progress}}" style="width: {{item.progress}}%;"></view>
        </view>
        <view class="video-title">{{item.title}}</view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" tt:elif="{{!loading}}">
      <image class="empty-icon" src="../../assets/icons/empty-video.png" mode="aspectFit"></image>
      <view class="empty-text">
        {{activeTab === 'favorites' ? 'æš‚æ— æ”¶è—è§†é¢‘' : 'æš‚æ— è§‚çœ‹è®°å½•'}}
      </view>
    </view>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-container" tt:if="{{loading}}">
      <view class="loading-spinner"></view>
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>
    
    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" tt:if="{{!loading && ((activeTab === 'favorites' && !hasMoreFavorites) || (activeTab === 'history' && !hasMoreHistory)) && videos.length > 0}}">
      <text>æ²¡æœ‰æ›´å¤šå†…å®¹äº†</text>
    </view>
  </block>
  
  <!-- æ·»åŠ ä¸€ä¸ªå›ºå®šåœ¨åº•éƒ¨çš„å¯¼èˆªæ  -->
  <view class="profile-tab-bar">
    <view class="profile-tab-item" bindtap="navigateToIndex">
      <view class="profile-tab-icon">ğŸ </view>
      <view class="profile-tab-text">é¦–é¡µ</view>
    </view>
    <view class="profile-tab-item" bindtap="navigateToRecommend">
      <view class="profile-tab-icon">ğŸ”</view>
      <view class="profile-tab-text">æ¨è</view>
    </view>
    <view class="profile-tab-item profile-tab-active">
      <view class="profile-tab-icon">ğŸ‘¤</view>
      <view class="profile-tab-text">æˆ‘çš„</view>
    </view>
  </view>
</view> 